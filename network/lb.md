## ロードバランサ

L4かL7で負荷分散する装置。ここまでは知ってる

## 仕組み

クライアントからサーバに送受信する流れだと

- クライアントがLB内の仮想サーバにアクセス
- LBで動的にNATして、サーバに転送
- サーバがLBにレスポンスして、仮想サーバのIPに変換
- 仮想サーバがクライアントにレスポンスを送信

- [ロードバランサーの動作 \- ネットワークエンジニアを目指して](https://www.itbook.info/network/apl.html)

## DSR

ワンアーム構成において、クライアントからのリクエストをLB介さずに直接クライアントに返す方式
現状あまり使われていない。

## 設定
- VIP
- Loopbackアドレスの設定（IFが必要）
- LB経由しないstatic route

### メリット
- LB介さないのでスループット向上
- LB側で送信元アドレスを変換する必要なし

### デメリット
- L4でしか動作しない
- LBへのSSL終端はできない
- VIPの設定が必要


## 参考

- [DSR（Direct Server Return）とは](https://www.infraexpert.com/study/loadbalancer12.html)

